<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ASM Sport Club Budget Tracker</title>
  <style>
    /* --- Your existing CSS (kept the same) --- */
    * { margin:0; padding:0; box-sizing:border-box; }
    body { font-family:'Calibri', Arial, sans-serif; background:linear-gradient(135deg,#f5f7fa 0%,#c3cfe2 100%); min-height:100vh; color:#333; }
    .container { max-width:1400px; margin:0 auto; padding:20px; }
    .header { text-align:center; background:white; padding:30px; border-radius:15px; box-shadow:0 8px 32px rgba(0,0,0,0.1); margin-bottom:30px; border-left:5px solid #4a90e2; }
    .company-name { font-size:2.5em; font-weight:bold; color:#2c3e50; margin-bottom:15px; letter-spacing:1px; }
    .presidents { font-size:1.1em; color:#34495e; margin-bottom:10px; }
    .card { background:white; border-radius:15px; padding:25px; margin-bottom:25px; box-shadow:0 8px 32px rgba(0,0,0,0.1); border-left:5px solid #4a90e2; }
    .card-title { font-size:1.4em; font-weight:bold; color:#2c3e50; margin-bottom:20px; display:flex; align-items:center; gap:10px; }
    .form-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(250px,1fr)); gap:20px; margin-bottom:20px; }
    .form-group { display:flex; flex-direction:column; }
    label { font-weight:600; margin-bottom:8px; color:#2c3e50; font-size:0.95em; }
    input, select, textarea { padding:12px; border:2px solid #e1e8ed; border-radius:8px; font-size:1em; font-family:'Calibri', Arial, sans-serif; transition:all 0.3s ease; }
    input:focus, select:focus, textarea:focus { outline:none; border-color:#4a90e2; box-shadow:0 0 0 3px rgba(74,144,226,0.1); }
    .btn { padding:12px 25px; border:none; border-radius:8px; font-size:1em; font-weight:600; cursor:pointer; transition:all 0.3s ease; font-family:'Calibri', Arial, sans-serif; }
    .btn-primary { background:linear-gradient(135deg,#4a90e2,#357abd); color:white; }
    .btn-primary:hover { transform:translateY(-2px); box-shadow:0 8px 25px rgba(74,144,226,0.3); }
    .btn-success { background:linear-gradient(135deg,#27ae60,#229954); color:white; }
    .btn-success:hover { transform:translateY(-2px); box-shadow:0 8px 25px rgba(39,174,96,0.3); }
    .btn-export { background:linear-gradient(135deg,#e67e22,#d35400); color:white; }
    .btn-export:hover { transform:translateY(-2px); box-shadow:0 8px 25px rgba(230,126,34,0.3); }
    .summary-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(300px,1fr)); gap:25px; margin-bottom:30px; }
    .summary-card { background:linear-gradient(135deg,#74b9ff 0%,#0984e3 100%); color:white; padding:25px; border-radius:15px; text-align:center; box-shadow:0 8px 32px rgba(0,0,0,0.15); transition:transform 0.3s ease; }
    .summary-card:hover { transform:translateY(-5px); }
    .summary-value { font-size:2.2em; font-weight:bold; margin-bottom:10px; }
    .summary-label { font-size:1em; opacity:0.9; }
    table { width:100%; border-collapse:collapse; background:white; border-radius:15px; overflow:hidden; }
    th { background:linear-gradient(135deg,#95a5a6 0%,#7f8c8d 100%); color:white; padding:15px; text-align:left; font-weight:600; font-size:0.9em; }
    td { padding:15px; border-bottom:1px solid #e1e8ed; }
    tr:hover { background-color:#f8f9fa; }
    .currency { text-align:right; font-weight:600; color:#27ae60; }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="company-name">ADVANCED SERVICES AND MAINTENANCE</div>
      <div class="presidents">
        Current Presidents:
        <span id="president1">Jeremy MERCADAL</span> and
        <span id="president2">Maxence ESTIEVENART</span>
        for <span id="currentYear">2025</span>
      </div>
    </div>

    <!-- Budget Setup -->
    <div class="card">
      <div class="card-title">ðŸ’° Annual Budget Setup</div>
      <div class="form-grid">
        <div class="form-group"><label for="budgetYear">Year</label><input type="number" id="budgetYear" value="2025" min="2020" max="2030"></div>
        <div class="form-group"><label for="totalBudget">Total Allocated Budget (QAR)</label><input type="number" id="totalBudget" step="0.01"></div>
        <div class="form-group"><label for="reimbursementCap">Reimbursement Cap (15%)</label><input type="number" id="reimbursementCap" class="auto-field" readonly></div>
      </div>
      <button class="btn btn-primary" onclick="updateBudget()">ðŸ’¾ Update Budget</button>
    </div>

    <!-- Summary -->
    <div class="summary-grid">
      <div class="summary-card"><div class="summary-value" id="summaryReimbursementCap">0.00 QAR</div><div class="summary-label">Company Reimbursement Cap (15%)</div></div>
      <div class="summary-card"><div class="summary-value" id="summaryTotalReimbursed">0.00 QAR</div><div class="summary-label">Total Reimbursed So Far</div></div>
      <div class="summary-card"><div class="summary-value" id="summaryRemainingReimbursement">0.00 QAR</div><div class="summary-label">Remaining Reimbursement Budget</div></div>
      <div class="summary-card"><div class="summary-value" id="summaryRemainingClub">0.00 QAR</div><div class="summary-label">Remaining Club Budget</div></div>
    </div>

    <!-- Activity Form -->
    <div class="card">
      <div class="card-title">ðŸ“‹ Activity Entry Form</div>
      <div class="form-grid">
        <div class="form-group"><label for="activityType">Activity Type</label><select id="activityType"><option value="">Select Activity</option><option value="Football">Football</option><option value="Padel">Padel</option><option value="Karting">Karting</option></select></div>
        <div class="form-group"><label for="supplier">Supplier</label><input type="text" id="supplier"></div>
        <div class="form-group"><label for="activityDate">Date</label><input type="date" id="activityDate"></div>
        <div class="form-group"><label for="invoiceNumber">Invoice #</label><input type="text" id="invoiceNumber"></div>
        <div class="form-group"><label for="totalInvoice">Total Invoice (QAR)</label><input type="number" id="totalInvoice" step="0.01"></div>
        <div class="form-group"><label for="totalParticipants">Number of Participants</label><input type="number" id="totalParticipants" min="1"></div>
        <div class="form-group"><label for="perPersonCost">Per Person Cost</label><input type="number" id="perPersonCost" readonly></div>
        <div class="form-group"><label for="asmEmployees">ASM Employees Participating</label><input type="number" id="asmEmployees" min="0"></div>
        <div class="form-group"><label for="eligibleAmount">Eligible ASM Amount</label><input type="number" id="eligibleAmount"></div>
        <div class="form-group"><label for="reimbursementAmount">Reimbursement (15%)</label><input type="number" id="reimbursementAmount" readonly></div>
        <div class="form-group"><label for="eureciaNumber">EURECIA Expense #</label><input type="text" id="eureciaNumber"></div>
      </div>
      <button class="btn btn-success" onclick="addActivity()">âž• Add Activity</button>
    </div>

    <!-- Activities -->
    <div class="card">
      <div class="card-title">ðŸ“Š Activities Breakdown</div>
      <div class="table-container">
        <table id="activitiesTable"><thead><tr><th>Activity</th><th>Date</th><th>Supplier</th><th>Invoice</th><th>Total (QAR)</th><th>Participants</th><th>ASM Employees</th><th>Eligible (QAR)</th><th>Reimbursement</th><th>EURECIA</th></tr></thead><tbody id="activitiesTableBody"></tbody></table>
      </div>
    </div>
  </div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js"></script>

  <script>
    // ðŸ”‘ Replace with your Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyD7qAww543Re2SoXhHr8ParK26TZz6AgD4",
      authDomain: "asm-sport-club.firebaseapp.com",
      projectId: "asm-sport-club",
      storageBucket: "asm-sport-club.firebasestorage.app",
      messagingSenderId: "811938939629",
      appId: "1:811938939629:web:26fb732b5125fb0caf42e4"
    };

    // Init Firebase
    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // App data
    let appData = { budget: { year:2025, totalBudget:0, reimbursementCap:0 }, activities:[] };

    // Load data from Firebase
    async function loadData() {
      const docRef = db.collection("club").doc("main");
      const docSnap = await docRef.get();
      if (docSnap.exists) {
        appData = docSnap.data();
        updateUI();
      }
    }

    // Save data to Firebase
    async function saveData() {
      await db.collection("club").doc("main").set(appData);
    }

    // Update UI
    function updateUI() {
      document.getElementById('budgetYear').value = appData.budget.year;
      document.getElementById('totalBudget').value = appData.budget.totalBudget;
      document.getElementById('reimbursementCap').value = appData.budget.reimbursementCap;
      updateSummary();
      updateActivitiesTable();
    }

    // Update budget
    async function updateBudget() {
      const year = parseInt(document.getElementById('budgetYear').value);
      const totalBudget = parseFloat(document.getElementById('totalBudget').value) || 0;
      const reimbursementCap = totalBudget * 0.15;
      appData.budget = { year, totalBudget, reimbursementCap };
      document.getElementById('reimbursementCap').value = reimbursementCap.toFixed(2);
      updateSummary();
      await saveData();
    }

    // Add activity
    async function addActivity() {
      const activity = {
        id: Date.now(),
        activityType: document.getElementById('activityType').value,
        supplier: document.getElementById('supplier').value,
        date: document.getElementById('activityDate').value,
        invoiceNumber: document.getElementById('invoiceNumber').value,
        totalInvoice: parseFloat(document.getElementById('totalInvoice').value) || 0,
        totalParticipants: parseInt(document.getElementById('totalParticipants').value) || 0,
        perPersonCost: 0,
        asmEmployees: parseInt(document.getElementById('asmEmployees').value) || 0,
        eligibleAmount: parseFloat(document.getElementById('eligibleAmount').value) || 0,
        reimbursementAmount: parseFloat(document.getElementById('eligibleAmount').value) * 0.15,
        eureciaNumber: document.getElementById('eureciaNumber').value
      };
      activity.perPersonCost = activity.totalParticipants>0? activity.totalInvoice/activity.totalParticipants:0;
      appData.activities.push(activity);
      updateActivitiesTable();
      updateSummary();
      await saveData();
    }

    // Update table
    function updateActivitiesTable() {
      const tbody = document.getElementById('activitiesTableBody');
      tbody.innerHTML = '';
      appData.activities.forEach(a => {
        const row = `<tr>
          <td>${a.activityType}</td>
          <td>${a.date}</td>
          <td>${a.supplier}</td>
          <td>${a.invoiceNumber}</td>
          <td class="currency">${a.totalInvoice.toFixed(2)}</td>
          <td>${a.totalParticipants}</td>
          <td>${a.asmEmployees}</td>
          <td class="currency">${a.eligibleAmount.toFixed(2)}</td>
          <td class="currency">${a.reimbursementAmount.toFixed(2)}</td>
          <td>${a.eureciaNumber}</td>
        </tr>`;
        tbody.innerHTML += row;
      });
    }

    // Update summary
    function updateSummary() {
      const totalReimbursed = appData.activities.reduce((s,a)=>s+a.reimbursementAmount,0);
      const totalEligible = appData.activities.reduce((s,a)=>s+a.eligibleAmount,0);
      const remainingReimbursement = appData.budget.reimbursementCap - totalReimbursed;
      const remainingClub = appData.budget.totalBudget - totalEligible;
      document.getElementById('summaryReimbursementCap').textContent = `${appData.budget.reimbursementCap.toFixed(2)} QAR`;
      document.getElementById('summaryTotalReimbursed').textContent = `${totalReimbursed.toFixed(2)} QAR`;
      document.getElementById('summaryRemainingReimbursement').textContent = `${remainingReimbursement.toFixed(2)} QAR`;
      document.getElementById('summaryRemainingClub').textContent = `${remainingClub.toFixed(2)} QAR`;
    }

    // Load when ready
    document.addEventListener('DOMContentLoaded', loadData);
  </script>
</body>
</html>
